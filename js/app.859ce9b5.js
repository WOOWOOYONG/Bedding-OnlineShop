(function(){"use strict";var t={1526:function(t,e,o){var r=o(9242),s=o(1020),a=o(3396);function l(t,e){const o=(0,a.up)("router-link"),r=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("nav",null,[(0,a.Wm)(o,{to:"/"},{default:(0,a.w5)((()=>[(0,a.Uk)("Home")])),_:1}),(0,a.Uk)(" | "),(0,a.Wm)(o,{to:"/backstage"},{default:(0,a.w5)((()=>[(0,a.Uk)("後台管理")])),_:1})]),(0,a.Wm)(r)],64)}var n=o(89);const i={},c=(0,n.Z)(i,[["render",l]]);var d=c,u=o(2483);const m={class:"home"};function p(t,e,o,r,s,l){const n=(0,a.up)("ProductList"),i=(0,a.up)("CartList"),c=(0,a.up)("ShippingForm");return(0,a.wg)(),(0,a.iD)("div",m,[(0,a.Wm)(n,{"product-url":s.productUrl,"customer-url":s.customerUrl},null,8,["product-url","customer-url"]),(0,a.Wm)(i,{"customer-url":s.customerUrl},null,8,["customer-url"]),(0,a.Wm)(c,{"order-url":s.orderUrl},null,8,["order-url"])])}var h=o(7139);const g=(0,a._)("h1",{class:"text-3xl text-indigo-700 text-center my-5 mx-auto"},"床具選購",-1),y={class:"mx-auto max-w-[60%]"},f={class:"grid sm:grid-cols md:grid-cols-4 gap-10 px-20"},_={class:"font-medium text-center mb-3"},b=["src"],w={class:"my-3"},v={class:"mx-2"},x={class:"mx-2 font-bold"},C={class:""},k=(0,a._)("span",{class:"mr-2"},"數量",-1),j=(0,a.uE)('<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option>',9),O=[j],T=["data-id"];function U(t,e,o,r,s,l){return(0,a.wg)(),(0,a.iD)("div",null,[g,(0,a._)("div",y,[(0,a._)("ul",f,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.products,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"col-span-1",key:t.id},[(0,a._)("h3",_,(0,h.zw)(t.title),1),(0,a._)("img",{src:t.images,alt:"product-pic",class:"w-full"},null,8,b),(0,a._)("div",w,[(0,a._)("span",v,"原價"+(0,h.zw)(t.origin_price),1),(0,a._)("span",x,"特價"+(0,h.zw)(t.price),1)]),(0,a._)("div",C,[(0,a._)("div",null,[k,(0,a._)("select",{class:(0,h.C_)("num"+t.id)},O,2)]),(0,a._)("button",{"data-id":t.id,onClick:e[0]||(e[0]=(...t)=>l.addToCart&&l.addToCart(...t)),class:"mt-2 w-full py-2 border-2 hover:bg-gray-100"}," 加入購物車 ",8,T)])])))),128))])])])}var L=(0,s.Q_)("cartList",{state:()=>({cartItems:[],cartTotal:null}),getters:{},actions:{async getCartList(){const t="https://livejs-api.hexschool.io/api/livejs/v1/customer/woowooyong/carts";try{const e=await fetch(t),o=await e.json();this.cartItems=o.carts,this.cartTotal=o.finalTotal,console.log(o)}catch(e){console.log(e)}}}}),I={props:["productUrl","customerUrl"],data(){return{products:[]}},methods:{async getProductList(){try{const t=await fetch(this.productUrl),e=await t.json();this.products=e.products,console.log(this.products)}catch(t){console.log(t)}},async addToCart(t){const e=t.target.dataset.id,o=document.querySelector(`.num${e}`).value,r={data:{productId:e,quantity:parseInt(o)}};try{const t=await fetch(this.customerUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),e=await t.json();this.getCartList(),console.log(e)}catch(s){console.log(s)}},...(0,s.nv)(L,["getCartList"])},created(){this.getProductList()}};const z=(0,n.Z)(I,[["render",U]]);var A=z;const D={class:"mt-10 bg-gray-50"},S=(0,a._)("h1",{class:"text-2xl text-center pt-5"},"我的購物車",-1),q={class:"table-auto mx-auto mt-10"},N=(0,a._)("thead",null,[(0,a._)("tr",{class:"border-b border-slate-300"},[(0,a._)("th",{class:"text-center p-5"},"品項"),(0,a._)("th",{class:"text-center p-5"},"單價"),(0,a._)("th",{class:"text-center p-5"},"數量"),(0,a._)("th",{class:"text-center p-5"},"金額")])],-1),E={class:"p-5"},P={class:"flex items-center"},H=["src"],W={class:"ml-5"},Z={class:"p-5"},M={class:"p-5"},V={class:"flex items-center gap-2"},$=["data-id"],J=["value","data-id"],K=["data-id"],Y={class:"p-5"},F={class:"p-5"},B=["data-id"],Q={class:"p-5"},X=(0,a._)("td",{class:"p-5"},null,-1),G=(0,a._)("td",{class:"p-5"},null,-1),R=(0,a._)("td",{class:"p-5"},"總金額",-1),tt={class:"p-5"};function et(t,e,o,r,s,l){return(0,a.wg)(),(0,a.iD)("div",D,[S,(0,a._)("table",q,[N,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.cartItems,(t=>((0,a.wg)(),(0,a.iD)("tr",{class:"border-b-2",key:t.id},[(0,a._)("td",E,[(0,a._)("div",P,[(0,a._)("img",{src:t.product.images,alt:"product-image",class:"w-20"},null,8,H),(0,a._)("span",W,(0,h.zw)(t.product.title),1)])]),(0,a._)("td",Z,(0,h.zw)(t.product.price),1),(0,a._)("td",M,[(0,a._)("div",V,[(0,a._)("span",{"data-id":t.id,onClick:e[0]||(e[0]=(...t)=>l.minusCartItemNum&&l.minusCartItemNum(...t)),class:"cursor-pointer"}," － ",8,$),(0,a._)("input",{type:"number",disabled:"",class:(0,h.C_)(["border-2 text-center w-10","cartNum"+t.id]),min:"1",max:"9",value:t.quantity,"data-id":t.id},null,10,J),(0,a._)("span",{onClick:e[1]||(e[1]=(...t)=>l.plusCartItemNum&&l.plusCartItemNum(...t)),"data-id":t.id,class:"cursor-pointer"}," ＋ ",8,K)])]),(0,a._)("td",Y,(0,h.zw)(t.product.price*t.quantity),1),(0,a._)("td",F,[(0,a._)("button",{"data-id":t.id,onClick:e[2]||(e[2]=(...t)=>l.delCartItem&&l.delCartItem(...t))},"X",8,B)])])))),128)),(0,a._)("tr",null,[(0,a._)("td",Q,[(0,a._)("button",{class:"discardAllBtn w-full bg-orange-100 p-3",onClick:e[3]||(e[3]=(...t)=>l.delAllCartItems&&l.delAllCartItems(...t))}," 刪除所有品項 ")]),X,G,R,(0,a._)("td",tt,(0,h.zw)(t.cartTotal),1)])])])])}var ot={props:["customerUrl"],data(){return{}},computed:{...(0,s.rn)(L,["cartItems","cartTotal"])},methods:{...(0,s.nv)(L,["getCartList"]),async delAllCartItems(){if(this.cartItems.length>0){let e=confirm("確定刪除所有品項？");if(e)try{const t=await fetch(this.customerUrl,{method:"DELETE",headers:{"Content-Type":"application/json"}}),e=await t.json();console.log(e.message),this.getCartList()}catch(t){console.log(t)}}},async delCartItem(t){const e=t.target.dataset.id;try{const t=await fetch(`${this.customerUrl}/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});t.ok&&(console.log("刪除成功"),this.getCartList())}catch(o){console.log(o)}},minusCartItemNum(t){const e=t.target.dataset.id,o=document.querySelector(`.cartNum${e}`),r=parseInt(o.value);if(r>1){const t=r-1;o.value=t;const s={data:{id:e,quantity:t}};this.modifyCartItemNum(s)}},plusCartItemNum(t){const e=t.target.dataset.id,o=document.querySelector(`.cartNum${e}`),r=parseInt(o.value);if(r<9){const t=r+1;o.value=t;const s={data:{id:e,quantity:t}};this.modifyCartItemNum(s)}},async modifyCartItemNum(t){try{const e=await fetch(this.customerUrl,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await e.json();console.log(o),this.getCartList()}catch(e){console.log(e)}}},created(){this.getCartList()}};const rt=(0,n.Z)(ot,[["render",et]]);var st=rt;const at=(0,a._)("h2",{class:"text-2xl text-center pt-5"},"填寫預訂資料",-1),lt={class:"flex flex-col max-w-[20%] mx-auto"},nt=(0,a._)("label",{for:"name",class:"text-left"},"姓名",-1),it={class:"flex flex-col max-w-[20%] mx-auto"},ct=(0,a._)("label",{for:"phone",class:"text-left"},"電話",-1),dt={class:"flex flex-col max-w-[20%] mx-auto"},ut=(0,a._)("label",{for:"email",class:"text-left"},"Email",-1),mt={class:"flex flex-col max-w-[20%] mx-auto"},pt=(0,a._)("label",{for:"address",class:"text-left"},"寄送地址",-1),ht={class:"flex flex-col max-w-[20%] mx-auto"},gt=(0,a._)("label",{for:"tradeWay",class:"text-left"},"交易方式",-1),yt=(0,a._)("option",{value:"ATM"},"ATM",-1),ft=(0,a._)("option",{value:"信用卡"},"信用卡",-1),_t=(0,a._)("option",{value:"超商付款"},"超商付款",-1),bt=[yt,ft,_t],wt={class:"max-w-[20%] mx-auto text-left my-2"},vt=(0,a._)("p",{class:"inline-block ml-5"},"已閱讀並同意本站購物條款",-1),xt=(0,a._)("button",{type:"submit",class:"my-3 bg-orange-100 py-2 px-3"}," 送出預定資料 ",-1);function Ct(t,e,o,s,l,n){return(0,a.wg)(),(0,a.iD)("div",null,[at,(0,a._)("form",{class:"mt-5",onSubmit:e[6]||(e[6]=(0,r.iM)(((...t)=>n.handleSubmit&&n.handleSubmit(...t)),["prevent"]))},[(0,a._)("div",lt,[nt,(0,a.wy)((0,a._)("input",{type:"text",placeholder:"請輸入姓名",class:"border-2 my-2 py-2 indent-1",name:"customerName",required:"","onUpdate:modelValue":e[0]||(e[0]=t=>l.customer.name=t)},null,512),[[r.nr,l.customer.name]])]),(0,a._)("div",it,[ct,(0,a.wy)((0,a._)("input",{type:"text",placeholder:"請輸入電話",class:"border-2 my-2 py-2 indent-1",name:"customerPhone",required:"","onUpdate:modelValue":e[1]||(e[1]=t=>l.customer.phone=t)},null,512),[[r.nr,l.customer.phone]])]),(0,a._)("div",dt,[ut,(0,a.wy)((0,a._)("input",{type:"mail",placeholder:"請輸入Email",class:"border-2 my-2 py-2 indent-1",name:"customerEmail",required:"","onUpdate:modelValue":e[2]||(e[2]=t=>l.customer.email=t)},null,512),[[r.nr,l.customer.email]])]),(0,a._)("div",mt,[pt,(0,a.wy)((0,a._)("input",{type:"text",placeholder:"請輸入寄送地址",class:"border-2 my-2 py-2 indent-1",name:"customerAddress",required:"","onUpdate:modelValue":e[3]||(e[3]=t=>l.customer.address=t)},null,512),[[r.nr,l.customer.address]])]),(0,a._)("div",ht,[gt,(0,a.wy)((0,a._)("select",{class:"border-2 my-2 py-2","onUpdate:modelValue":e[4]||(e[4]=t=>l.customer.payment=t)},bt,512),[[r.bM,l.customer.payment]])]),(0,a._)("div",wt,[(0,a.wy)((0,a._)("input",{type:"checkbox",class:"cursor-pointer",required:"","onUpdate:modelValue":e[5]||(e[5]=t=>l.customer.accept=t)},null,512),[[r.e8,l.customer.accept]]),vt]),xt],32)])}var kt={props:["orderUrl"],data(){return{customer:{name:"",email:"",phone:"",address:"",payment:"ATM",accept:!1}}},methods:{handleSubmit(){""!==this.customer.name||""!==this.customer.phone||""!==this.customer.email||""!==this.customer.address?!1!==this.customer.accept?this.createOrder():alert("需先同意本站條款才可購買"):alert("請填寫正確資料")},async createOrder(){const t={data:{user:{name:this.customer.name,tel:this.customer.phone,email:this.customer.email,address:this.customer.address,payment:this.customer.payment}}};try{const e=await fetch(this.orderUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await e.json();console.log(o),o.status?(this.customer.name="",this.customer.email="",this.customer.phone="",this.customer.address="",this.customer.payment="ATM",this.customer.accept=!1,this.getCartList()):console.error("訂單提交失敗")}catch(e){console.log(e)}},...(0,s.nv)(L,["getCartList"])}};const jt=(0,n.Z)(kt,[["render",Ct]]);var Ot=jt,Tt={name:"HomeView",components:{ProductList:A,CartList:st,ShippingForm:Ot},data(){return{productUrl:"https://livejs-api.hexschool.io/api/livejs/v1/customer/woowooyong/products",customerUrl:"https://livejs-api.hexschool.io/api/livejs/v1/customer/woowooyong/carts",orderUrl:"https://livejs-api.hexschool.io/api/livejs/v1/customer/woowooyong/orders"}}};const Ut=(0,n.Z)(Tt,[["render",p]]);var Lt=Ut;const It={class:"max-w-[80%] mx-auto"},zt=(0,a._)("h1",{class:"text-3xl"},"訂單明細",-1),At={key:0},Dt={key:1},St={class:"mx-auto my-10 border-collapse"},qt=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"p-4 border border-slate-300"},"訂單編號"),(0,a._)("th",{class:"p-4 border border-slate-300"},"聯絡人"),(0,a._)("th",{class:"p-4 border border-slate-300"},"聯絡地址"),(0,a._)("th",{class:"p-4 border border-slate-300"},"電子郵件"),(0,a._)("th",{class:"p-4 border border-slate-300"},"訂單品項"),(0,a._)("th",{class:"p-4 border border-slate-300"},"訂單日期"),(0,a._)("th",{class:"p-4 border border-slate-300"},"訂單狀態"),(0,a._)("th",{class:"p-4 border border-slate-300"},"操作")])],-1),Nt={class:"p-5 border border-slate-300"},Et={class:"p-5 border border-slate-300"},Pt={class:"font-bold"},Ht={class:"p-5 border border-slate-300"},Wt={class:"p-5 border border-slate-300"},Zt={class:"p-5 text-left border border-slate-300"},Mt={class:"p-5 border border-slate-300"},Vt={class:"p-5 border border-slate-300 bg-"},$t=["data-id"],Jt={class:"p-5 border border-slate-300"},Kt=["data-id"];function Yt(t,e,o,r,s,l){return(0,a.wg)(),(0,a.iD)("div",It,[zt,s.orders.length?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("h2",At,"目前沒有訂單")),s.orders.length?((0,a.wg)(),(0,a.iD)("div",Dt,[(0,a._)("button",{onClick:e[0]||(e[0]=(...t)=>l.deleteAllOrder&&l.deleteAllOrder(...t)),class:"mt-5 py-2 px-3 rounded-md bg-amber-200"}," 刪除全部訂單 "),(0,a._)("table",St,[qt,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.orders,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",Nt,(0,h.zw)(t.createdAt),1),(0,a._)("td",Et,[(0,a._)("p",Pt,(0,h.zw)(t.user.name),1),(0,a._)("p",null,(0,h.zw)(t.user.tel),1)]),(0,a._)("td",Ht,(0,h.zw)(t.user.address),1),(0,a._)("td",Wt,(0,h.zw)(t.user.email),1),(0,a._)("td",Zt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.products,(t=>((0,a.wg)(),(0,a.iD)("p",{key:t.id},(0,h.zw)(t.title),1)))),128))]),(0,a._)("td",Mt,(0,h.zw)(new Date(1e3*t.createdAt).toISOString().slice(0,10).replace("T"," ")),1),(0,a._)("td",Vt,[(0,a._)("button",{onClick:e[1]||(e[1]=(...t)=>l.confirmPayment&&l.confirmPayment(...t)),"data-id":t.id,class:(0,h.C_)(["px-3 py-2 rounded-md text-white",t.paid?"bg-gray-500":"bg-red-600"])},(0,h.zw)(t.paid?"已付款":"未處理"),11,$t)]),(0,a._)("td",Jt,[(0,a._)("button",{"data-id":t.id,onClick:e[2]||(e[2]=(...t)=>l.deleteOrder&&l.deleteOrder(...t))},"刪除",8,Kt)])])))),128))])])])):(0,a.kq)("",!0)])}var Ft={name:"Backstage",data(){return{adminUrl:"https://livejs-api.hexschool.io/api/livejs/v1/admin/woowooyong/orders",token:"TPZHZLqfSOaqH1KzCtvwfSqAF1g2",orders:[]}},methods:{async getOrderList(){try{const t=await fetch(this.adminUrl,{headers:{Authorization:this.token}}),e=await t.json(),o=e.orders;this.orders!==o&&(this.orders=o),console.log(this.orders)}catch(t){console.log(t)}},async confirmPayment(t){const e=t.target.dataset.id;if("未處理"===t.target.innerText)try{const t=await fetch(this.adminUrl,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify({data:{id:e,paid:!0}})}),o=await t.json();console.log(o),this.getOrderList()}catch(o){console.log(o)}if("已付款"===t.target.innerText)try{const t=await fetch(this.adminUrl,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify({data:{id:e,paid:!1}})}),o=await t.json();console.log(o),this.getOrderList()}catch(o){console.log(o)}},async deleteOrder(t){const e=t.target.dataset.id;try{const t=await fetch(`${this.adminUrl}/${e}`,{method:"DELETE",headers:{Authorization:this.token}}),o=t.json();console.log(o),this.getOrderList()}catch(o){console.log(o)}},async deleteAllOrder(){try{const t=await fetch(this.adminUrl,{method:"DELETE",headers:{Authorization:this.token}}),e=await t.json();console.log(e.message),this.getOrderList()}catch(t){console.log(t)}}},mounted(){this.getOrderList()},watch:{orders:{handler(){}}}};const Bt=(0,n.Z)(Ft,[["render",Yt]]);var Qt=Bt;const Xt=[{path:"/",name:"home",component:Lt},{path:"/backstage",name:"backstage",component:Qt}],Gt=(0,u.p7)({history:(0,u.r5)(),routes:Xt});var Rt=Gt;o(1129);const te=(0,s.WB)(),ee=(0,r.ri)(d);ee.use(Rt),ee.use(te),ee.mount("#app")}},e={};function o(r){var s=e[r];if(void 0!==s)return s.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,o),a.exports}o.m=t,function(){var t=[];o.O=function(e,r,s,a){if(!r){var l=1/0;for(d=0;d<t.length;d++){r=t[d][0],s=t[d][1],a=t[d][2];for(var n=!0,i=0;i<r.length;i++)(!1&a||l>=a)&&Object.keys(o.O).every((function(t){return o.O[t](r[i])}))?r.splice(i--,1):(n=!1,a<l&&(l=a));if(n){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[r,s,a]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,r){var s,a,l=r[0],n=r[1],i=r[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(i)var d=i(o)}for(e&&e(r);c<l.length;c++)a=l[c],o.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return o.O(d)},r=self["webpackChunkbed_try_in_vue"]=self["webpackChunkbed_try_in_vue"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(1526)}));r=o.O(r)})();
//# sourceMappingURL=app.859ce9b5.js.map